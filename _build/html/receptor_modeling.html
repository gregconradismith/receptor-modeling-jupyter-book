

<!DOCTYPE html>


<html lang="en" >

  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" /><meta name="generator" content="Docutils 0.18.1: http://docutils.sourceforge.net/" />

    <title>Receptor models &#8212; Receptors</title>
  
  
  
  <script data-cfasync="false">
    document.documentElement.dataset.mode = localStorage.getItem("mode") || "";
    document.documentElement.dataset.theme = localStorage.getItem("theme") || "light";
  </script>
  
  <!-- Loaded before other Sphinx assets -->
  <link href="_static/styles/theme.css?digest=e353d410970836974a52" rel="stylesheet" />
<link href="_static/styles/bootstrap.css?digest=e353d410970836974a52" rel="stylesheet" />
<link href="_static/styles/pydata-sphinx-theme.css?digest=e353d410970836974a52" rel="stylesheet" />

  
  <link href="_static/vendor/fontawesome/6.1.2/css/all.min.css?digest=e353d410970836974a52" rel="stylesheet" />
  <link rel="preload" as="font" type="font/woff2" crossorigin href="_static/vendor/fontawesome/6.1.2/webfonts/fa-solid-900.woff2" />
<link rel="preload" as="font" type="font/woff2" crossorigin href="_static/vendor/fontawesome/6.1.2/webfonts/fa-brands-400.woff2" />
<link rel="preload" as="font" type="font/woff2" crossorigin href="_static/vendor/fontawesome/6.1.2/webfonts/fa-regular-400.woff2" />

    <link rel="stylesheet" type="text/css" href="_static/pygments.css" />
    <link rel="stylesheet" href="_static/styles/sphinx-book-theme.css?digest=14f4ca6b54d191a8c7657f6c759bf11a5fb86285" type="text/css" />
    <link rel="stylesheet" type="text/css" href="_static/togglebutton.css" />
    <link rel="stylesheet" type="text/css" href="_static/copybutton.css" />
    <link rel="stylesheet" type="text/css" href="_static/mystnb.4510f1fc1dee50b3e5859aac5469c37c29e427902b24a333a5f9fcb2f0b3ac41.css" />
    <link rel="stylesheet" type="text/css" href="_static/sphinx-thebe.css" />
    <link rel="stylesheet" type="text/css" href="_static/design-style.4045f2051d55cab465a707391d5b2007.min.css" />
  
  <!-- Pre-loaded scripts that we'll load fully later -->
  <link rel="preload" as="script" href="_static/scripts/bootstrap.js?digest=e353d410970836974a52" />
<link rel="preload" as="script" href="_static/scripts/pydata-sphinx-theme.js?digest=e353d410970836974a52" />

    <script data-url_root="./" id="documentation_options" src="_static/documentation_options.js"></script>
    <script src="_static/jquery.js"></script>
    <script src="_static/underscore.js"></script>
    <script src="_static/_sphinx_javascript_frameworks_compat.js"></script>
    <script src="_static/doctools.js"></script>
    <script src="_static/clipboard.min.js"></script>
    <script src="_static/copybutton.js"></script>
    <script src="_static/scripts/sphinx-book-theme.js?digest=5a5c038af52cf7bc1a1ec88eea08e6366ee68824"></script>
    <script>let toggleHintShow = 'Click to show';</script>
    <script>let toggleHintHide = 'Click to hide';</script>
    <script>let toggleOpenOnPrint = 'true';</script>
    <script src="_static/togglebutton.js"></script>
    <script>var togglebuttonSelector = '.toggle, .admonition.dropdown';</script>
    <script src="_static/design-tabs.js"></script>
    <script>const THEBE_JS_URL = "https://unpkg.com/thebe@0.8.2/lib/index.js"
const thebe_selector = ".thebe,.cell"
const thebe_selector_input = "pre"
const thebe_selector_output = ".output, .cell_output"
</script>
    <script async="async" src="_static/sphinx-thebe.js"></script>
    <script async="async" src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js"></script>
    <script>DOCUMENTATION_OPTIONS.pagename = 'receptor_modeling';</script>
    <link rel="index" title="Index" href="genindex.html" />
    <link rel="search" title="Search" href="search.html" />
  <meta name="viewport" content="width=device-width, initial-scale=1"/>
  <meta name="docsearch:language" content="en"/>
  </head>
  
  
  <body data-bs-spy="scroll" data-bs-target=".bd-toc-nav" data-offset="180" data-bs-root-margin="0px 0px -60%" data-default-mode="">

  
  
  <a class="skip-link" href="#main-content">Skip to main content</a>
  
  <input type="checkbox"
          class="sidebar-toggle"
          name="__primary"
          id="__primary"/>
  <label class="overlay overlay-primary" for="__primary"></label>
  
  <input type="checkbox"
          class="sidebar-toggle"
          name="__secondary"
          id="__secondary"/>
  <label class="overlay overlay-secondary" for="__secondary"></label>
  
  <div class="search-button__wrapper">
    <div class="search-button__overlay"></div>
    <div class="search-button__search-container">
<form class="bd-search d-flex align-items-center"
      action="search.html"
      method="get">
  <i class="fa-solid fa-magnifying-glass"></i>
  <input type="search"
         class="form-control"
         name="q"
         id="search-input"
         placeholder="Search this book..."
         aria-label="Search this book..."
         autocomplete="off"
         autocorrect="off"
         autocapitalize="off"
         spellcheck="false"/>
  <span class="search-button__kbd-shortcut"><kbd class="kbd-shortcut__modifier">Ctrl</kbd>+<kbd>K</kbd></span>
</form></div>
  </div>
  
    <nav class="bd-header navbar navbar-expand-lg bd-navbar">
    </nav>
  
  <div class="bd-container">
    <div class="bd-container__inner bd-page-width">
      
      <div class="bd-sidebar-primary bd-sidebar">
        

  
  <div class="sidebar-header-items sidebar-primary__section">
    
    
    
    
  </div>
  
    <div class="sidebar-primary-items__start sidebar-primary__section">
        <div class="sidebar-primary-item">
  

<a class="navbar-brand logo" href="intro.html">
  
  
  
  
    
    
      
    
    
    <img src="_static/Doodle.png" class="logo__image only-light" alt="Logo image"/>
    <script>document.write(`<img src="_static/Doodle.png" class="logo__image only-dark" alt="Logo image"/>`);</script>
  
  
</a></div>
        <div class="sidebar-primary-item"><nav class="bd-links" id="bd-docs-nav" aria-label="Main">
    <div class="bd-toc-item navbar-nav active">
        
        <ul class="nav bd-sidenav bd-sidenav__home-link">
            <li class="toctree-l1">
                <a class="reference internal" href="intro.html">
                    Welcome to Receptors
                </a>
            </li>
        </ul>
        <p aria-level="2" class="caption" role="heading"><span class="caption-text">Receptor modeling</span></p>
<ul class="nav bd-sidenav">
<li class="toctree-l1"><a class="reference internal" href="receptor_modeling_overview.html">Receptor models</a></li>
<li class="toctree-l1"><a class="reference internal" href="receptor_modeling_ligands.html">Ligand binding</a></li>
<li class="toctree-l1"><a class="reference internal" href="receptor_modeling_equilibrium_formalism.html">Receptor modeling - equilibrium formalism</a></li>

<li class="toctree-l1"><a class="reference internal" href="receptor_modeling_scraps.html">Receptor modeling - scraps</a></li>
<li class="toctree-l1"><a class="reference internal" href="reduced_graph_powers.html">Reduced graph powers</a></li>
<li class="toctree-l1"><a class="reference internal" href="MyTools.html">My Tools</a></li>
<li class="toctree-l1"><a class="reference internal" href="MyToolsExamplesVertexAndEdgeLabels.html">Examples of using MyTools.ipynb - adding labels to receptor models</a></li>
<li class="toctree-l1"><a class="reference internal" href="MyToolsExamplesEnumerateAllostericParameters.html">Examples of using MyTools.ipynb - allosteric parameters in receptor dimers</a></li>
<li class="toctree-l1"><a class="reference internal" href="EnumerateAllostericParameters.html">Allosteric parameters in receptor dimers</a></li>
<li class="toctree-l1"><a class="reference internal" href="PlotBindingCurves.html">Plot Binding Curves</a></li>
<li class="toctree-l1"><a class="reference internal" href="markov_chains.html">Markov chain receptor models</a></li>
<li class="toctree-l1"><a class="reference internal" href="example_graphs.html">Example graphs</a></li>
</ul>
<p aria-level="2" class="caption" role="heading"><span class="caption-text">Receptor dimers</span></p>
<ul class="nav bd-sidenav">
<li class="toctree-l1"><a class="reference internal" href="overview.html">Overview</a></li>
<li class="toctree-l1"><a class="reference internal" href="2023-08-20-example-lmfit.html">example-lmfit</a></li>
<li class="toctree-l1"><a class="reference internal" href="2023-08-24-example-minimize-linear-regression.html">example-minimize-linear-regression.ipynb</a></li>
<li class="toctree-l1"><a class="reference internal" href="2023-08-25-plotting-hypercubes.html">plotting hypercube graphs</a></li>
<li class="toctree-l1"><a class="reference internal" href="2023-08-24-example-minimize-receptor-model-pade.html">example-minimize-receptor-model-pade.ipynb</a></li>
<li class="toctree-l1"><a class="reference internal" href="2023-08-21-practicing-python.html">practicing python</a></li>
</ul>
<p aria-level="2" class="caption" role="heading"><span class="caption-text">Higher-order oligomers</span></p>
<ul class="nav bd-sidenav">
<li class="toctree-l1"><a class="reference internal" href="example_reduced_graph_powers.html">Example Reduced Graph Powers</a></li>
<li class="toctree-l1"><a class="reference internal" href="ReducedFromCartesianPower.html">Reduced Power Graph</a></li>
<li class="toctree-l1"><a class="reference internal" href="wang_algebra.html">Wang algebra</a></li>
</ul>
<p aria-level="2" class="caption" role="heading"><span class="caption-text">Scraps and helps</span></p>
<ul class="nav bd-sidenav">
<li class="toctree-l1"><a class="reference internal" href="markdown.html">Markdown Files</a></li>
<li class="toctree-l1"><a class="reference internal" href="markdown-notebooks.html">Notebooks with MyST Markdown</a></li>
</ul>

    </div>
</nav></div>
    </div>
  
  
  <div class="sidebar-primary-items__end sidebar-primary__section">
  </div>
  
  <div id="rtd-footer-container"></div>


      </div>
      
      <main id="main-content" class="bd-main">
        
        

<div class="sbt-scroll-pixel-helper"></div>

          <div class="bd-content">
            <div class="bd-article-container">
              
              <div class="bd-header-article">
<div class="header-article-items header-article__inner">
  
    <div class="header-article-items__start">
      
        <div class="header-article-item"><label class="sidebar-toggle primary-toggle btn btn-sm" for="__primary" title="Toggle primary sidebar" data-bs-placement="bottom" data-bs-toggle="tooltip">
  <span class="fa-solid fa-bars"></span>
</label></div>
      
    </div>
  
  
    <div class="header-article-items__end">
      
        <div class="header-article-item">

<div class="article-header-buttons">





<div class="dropdown dropdown-source-buttons">
  <button class="btn dropdown-toggle" type="button" data-bs-toggle="dropdown" aria-expanded="false" aria-label="Source repositories">
    <i class="fab fa-github"></i>
  </button>
  <ul class="dropdown-menu">
      
      
      
      <li><a href="https://github.com/executablebooks/jupyter-book" target="_blank"
   class="btn btn-sm btn-source-repository-button dropdown-item"
   title="Source repository"
   data-bs-placement="left" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fab fa-github"></i>
  </span>
<span class="btn__text-container">Repository</span>
</a>
</li>
      
      
      
      
      <li><a href="https://github.com/executablebooks/jupyter-book/issues/new?title=Issue%20on%20page%20%2Freceptor_modeling.html&body=Your%20issue%20content%20here." target="_blank"
   class="btn btn-sm btn-source-issues-button dropdown-item"
   title="Open an issue"
   data-bs-placement="left" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fas fa-lightbulb"></i>
  </span>
<span class="btn__text-container">Open issue</span>
</a>
</li>
      
  </ul>
</div>






<div class="dropdown dropdown-download-buttons">
  <button class="btn dropdown-toggle" type="button" data-bs-toggle="dropdown" aria-expanded="false" aria-label="Download this page">
    <i class="fas fa-download"></i>
  </button>
  <ul class="dropdown-menu">
      
      
      
      <li><a href="_sources/receptor_modeling.md" target="_blank"
   class="btn btn-sm btn-download-source-button dropdown-item"
   title="Download source file"
   data-bs-placement="left" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fas fa-file"></i>
  </span>
<span class="btn__text-container">.md</span>
</a>
</li>
      
      
      
      
      <li>
<button onclick="window.print()"
  class="btn btn-sm btn-download-pdf-button dropdown-item"
  title="Print to PDF"
  data-bs-placement="left" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fas fa-file-pdf"></i>
  </span>
<span class="btn__text-container">.pdf</span>
</button>
</li>
      
  </ul>
</div>




<button onclick="toggleFullScreen()"
  class="btn btn-sm btn-fullscreen-button"
  title="Fullscreen mode"
  data-bs-placement="bottom" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fas fa-expand"></i>
  </span>

</button>


<script>
document.write(`
  <button class="theme-switch-button btn btn-sm btn-outline-primary navbar-btn rounded-circle" title="light/dark" aria-label="light/dark" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <span class="theme-switch" data-mode="light"><i class="fa-solid fa-sun"></i></span>
    <span class="theme-switch" data-mode="dark"><i class="fa-solid fa-moon"></i></span>
    <span class="theme-switch" data-mode="auto"><i class="fa-solid fa-circle-half-stroke"></i></span>
  </button>
`);
</script>

<script>
document.write(`
  <button class="btn btn-sm navbar-btn search-button search-button__button" title="Search" aria-label="Search" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <i class="fa-solid fa-magnifying-glass"></i>
  </button>
`);
</script>
<label class="sidebar-toggle secondary-toggle btn btn-sm" for="__secondary"title="Toggle secondary sidebar" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <span class="fa-solid fa-list"></span>
</label>
</div></div>
      
    </div>
  
</div>
</div>
              
              

<div id="jb-print-docs-body" class="onlyprint">
    <h1>Receptor models</h1>
    <!-- Table of contents -->
    <div id="print-main-content">
        <div id="jb-print-toc">
            
            <div>
                <h2> Contents </h2>
            </div>
            <nav aria-label="Page">
                <ul class="visible nav section-nav flex-column">
<li class="toc-h1 nav-item toc-entry"><a class="reference internal nav-link" href="#">Receptor models</a><ul class="visible nav section-nav flex-column">
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#states-and-transitions">States and transitions</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#transition-rate-constants">Transition rate constants</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#a-three-state-receptor-model">A three-state receptor model</a></li>
</ul>
</li>
<li class="toc-h1 nav-item toc-entry"><a class="reference internal nav-link" href="#scraps">Scraps</a><ul class="visible nav section-nav flex-column">
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#references">References</a></li>
</ul>
</li>
</ul>

            </nav>
        </div>
    </div>
</div>

              
                
<div id="searchbox"></div>
                <article class="bd-article" role="main">
                  
  <section id="receptor-models">
<h1>Receptor models<a class="headerlink" href="#receptor-models" title="Permalink to this heading">#</a></h1>
<p>Quantitative pharmacologists construct models of relationship between ligand concentration and the fraction of cell surface receptors in each of several molecular conformations. These models give insight into the action of natural ligands and drugs on receptor-mediated cell responses.  A good starting point for review of receptor modeling is</p>
<ul class="simple">
<li><p>Kenakin, T. P. (2018). <a class="reference external" href="https://www.amazon.com/Pharmacology-Primer-Techniques-Effective-Strategic/dp/0128139579/">A Pharmacology Primer: Techniques for More Effective and Strategic Drug Discovery.</a> Academic Press. <span id="id1">[<a class="reference internal" href="#id3" title="Terry P Kenakin. A pharmacology primer: techniques for more effective and strategic drug discovery. Academic Press, 2018.">Ken18</a>]</span></p></li>
</ul>
<p>An introction to this topic for undergraduate neuroscienc majors is <strong>Ligands, Receptors, and Rate Laws</strong>, Chapter 4 of <a class="reference external" href="https://www.cambridge.org/core/books/cellular-biophysics-and-modeling/0C728F4C44D89D8F3BA62E41A0D7336F">Cellular Biophysics &amp; Modeling: a primer on the computational biology of excitable cells</a>. Cambridge University Press, 2019.</p>
<section id="states-and-transitions">
<h2>States and transitions<a class="headerlink" href="#states-and-transitions" title="Permalink to this heading">#</a></h2>
<p>The process of receptor modeling often begins by specifying the molecular conformations (states) to be considered and the transitions between these states.  For example, the following graph may represent a receptor model that has four states:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">G_undirected</span> <span class="o">=</span> <span class="n">Graph</span><span class="p">({</span><span class="mi">1</span><span class="p">:</span> <span class="p">[</span><span class="mi">2</span><span class="p">,</span> <span class="mi">3</span><span class="p">],</span> <span class="mi">2</span><span class="p">:</span> <span class="p">[</span><span class="mi">3</span><span class="p">],</span> <span class="mi">3</span><span class="p">:</span> <span class="p">[</span><span class="mi">4</span><span class="p">]})</span>
<span class="n">vertex_positions</span> <span class="o">=</span> <span class="p">{</span><span class="mi">1</span><span class="p">:</span> <span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">),</span> <span class="mi">2</span><span class="p">:</span> <span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mf">1.41</span><span class="p">),</span> <span class="mi">3</span><span class="p">:</span> <span class="p">(</span><span class="mi">2</span><span class="p">,</span> <span class="mi">0</span><span class="p">),</span> <span class="mi">4</span><span class="p">:</span> <span class="p">(</span><span class="mi">4</span><span class="p">,</span><span class="mi">0</span><span class="p">)}</span>
<span class="n">G_undirected</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="mi">8</span><span class="p">,</span><span class="n">pos</span><span class="o">=</span><span class="n">vertex_positions</span><span class="p">,</span><span class="n">graph_border</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="_images/fef322840d716a86eade33751c36e8b5c19ba81ff1631d4fb333f9c316a125f7.png" src="_images/fef322840d716a86eade33751c36e8b5c19ba81ff1631d4fb333f9c316a125f7.png" />
</div>
</div>
<p>This graph <code class="docutils literal notranslate"><span class="pre">G_undirected</span></code> is constructed by calling the Sagemath command <a class="reference external" href="https://doc.sagemath.org/html/en/reference/graphs/sage/graphs/graph.html#supported-formats"><code class="docutils literal notranslate"><span class="pre">Graph()</span></code></a> with a dictionary that associates neighbors to each vertex.  The vertices of the graph <code class="docutils literal notranslate"><span class="pre">G</span></code> are the integers 1, 2, 3, and 4.  The method <code class="docutils literal notranslate"><span class="pre">plot()</span></code> shows the graph <code class="docutils literal notranslate"><span class="pre">G_undirected</span></code> using a dictionary <code class="docutils literal notranslate"><span class="pre">vertex_positions</span></code> that specifies the locations of each vertex.</p>
<p>The adjacency matrix of this graph is</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">A</span> <span class="o">=</span> <span class="n">G_undirected</span><span class="o">.</span><span class="n">adjacency_matrix</span><span class="p">()</span>
</pre></div>
</div>
</div>
</div>
<p>The incidence matrix of this graph is</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">E</span> <span class="o">=</span> <span class="n">G_undirected</span><span class="o">.</span><span class="n">incidence_matrix</span><span class="p">()</span>
</pre></div>
</div>
</div>
</div>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>The graphs used here to represent receptor states and transitions will be both connected and simple.</p>
<ul class="simple">
<li><p><em>Connected</em>: at least one path joins every pair of vertices.</p></li>
<li><p><em>Simple</em>: no loops or multiple edges.</p></li>
</ul>
</div>
<p>In the context of receptor modeling, the undirected graph above is interpreted as a short-hand for the following <em>directed</em> graph.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">G_directed</span> <span class="o">=</span> <span class="n">G_undirected</span><span class="o">.</span><span class="n">to_directed</span><span class="p">()</span>
<span class="n">G_directed</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="mi">8</span><span class="p">,</span><span class="n">edge_labels</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span><span class="n">pos</span><span class="o">=</span><span class="n">vertex_positions</span><span class="p">,</span><span class="n">graph_border</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="_images/a0f9d49971e968696c6e086ae38b6b8d99c657e55305b808c5483a29272245e9.png" src="_images/a0f9d49971e968696c6e086ae38b6b8d99c657e55305b808c5483a29272245e9.png" />
</div>
</div>
<p>The method <code class="docutils literal notranslate"><span class="pre">to_directed()</span></code> produces <code class="docutils literal notranslate"><span class="pre">G_directed</span></code> as the <em>symmetric</em> digraph associated to <code class="docutils literal notranslate"><span class="pre">G_undirected</span></code>, in which adjacent vertices are  connected in both directions.</p>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>Receptor state-transition diagrams  will always be symmetric directed graphs, that is, for every edge from vertex <code class="docutils literal notranslate"><span class="pre">i</span></code> to vertex <code class="docutils literal notranslate"><span class="pre">j</span></code>, there is also an edge from vertex <code class="docutils literal notranslate"><span class="pre">j</span></code> to vertex <code class="docutils literal notranslate"><span class="pre">i</span></code>.  Thus, the state-transtion diagrams for a receptor model may, for simplicity, be illustrated as an undirected graph.</p>
</div>
</section>
<section id="transition-rate-constants">
<h2>Transition rate constants<a class="headerlink" href="#transition-rate-constants" title="Permalink to this heading">#</a></h2>
<p>In the context of receptor modeling, state-transition diagrams are usually <em>weighted</em>, as shown here.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">var</span><span class="p">(</span><span class="s1">&#39;a12, a21, a13, a31, a23, a32, a34, a43&#39;</span><span class="p">)</span>
<span class="n">d</span> <span class="o">=</span> <span class="p">{</span><span class="mi">1</span><span class="p">:</span> <span class="p">{</span><span class="mi">2</span><span class="p">:</span><span class="n">a12</span><span class="p">,</span> <span class="mi">3</span><span class="p">:</span><span class="n">a13</span><span class="p">},</span> <span class="mi">2</span><span class="p">:</span> <span class="p">{</span><span class="mi">1</span><span class="p">:</span><span class="n">a21</span><span class="p">,</span> <span class="mi">3</span><span class="p">:</span><span class="n">a23</span><span class="p">},</span> <span class="mi">3</span><span class="p">:</span> <span class="p">{</span><span class="mi">2</span><span class="p">:</span><span class="n">a32</span><span class="p">,</span> <span class="mi">1</span><span class="p">:</span><span class="n">a31</span><span class="p">,</span> <span class="mi">4</span><span class="p">:</span><span class="n">a34</span><span class="p">},</span> <span class="mi">4</span><span class="p">:</span> <span class="p">{</span><span class="mi">3</span><span class="p">:</span><span class="n">a43</span><span class="p">}};</span>
<span class="n">G</span> <span class="o">=</span> <span class="n">DiGraph</span><span class="p">(</span><span class="n">d</span><span class="p">,</span><span class="n">weighted</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<span class="n">G</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="mi">8</span><span class="p">,</span><span class="n">edge_labels</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span><span class="n">pos</span><span class="o">=</span><span class="n">vertex_positions</span><span class="p">,</span><span class="n">graph_border</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="_images/09c72693977e3fec7249e1268228a932afd2cad72b0ba5cc1e5541357503ede7.png" src="_images/09c72693977e3fec7249e1268228a932afd2cad72b0ba5cc1e5541357503ede7.png" />
</div>
</div>
<p>In the code above, a directed graph <code class="docutils literal notranslate"><span class="pre">G</span></code> is constructed by calling the Sagemath command <a class="reference external" href="https://doc.sagemath.org/html/en/reference/graphs/sage/graphs/digraph.html#methods"><code class="docutils literal notranslate"><span class="pre">DiGraph()</span></code></a>.  The input argument <code class="docutils literal notranslate"><span class="pre">d</span></code> is a <a class="reference external" href="https://doc.sagemath.org/html/en/thematic_tutorials/tutorial-programming-python.html">Python dictionary</a> that assigns out-neighbors to each vertex and corresponding edge labels.
The edge labels are not <em>strings</em>, but <em>symbolic variables</em> defined using Sagemath’s <code class="docutils literal notranslate"><span class="pre">var</span></code> command.
For example, the symbolic variable <code class="docutils literal notranslate"><span class="pre">a12</span></code> stands for the rate of transition between state 1 and 2.</p>
<p>Because these rate constants are symbolic variables, Sagemath will evaluate expressions such as</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">f</span> <span class="o">=</span> <span class="n">a12</span> <span class="o">*</span> <span class="p">(</span><span class="n">a21</span> <span class="o">+</span> <span class="n">a13</span><span class="p">)</span><span class="o">^</span><span class="mi">2</span> <span class="o">/</span> <span class="n">a13</span>
<span class="n">f</span><span class="o">.</span><span class="n">expand</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>a12*a13 + 2*a12*a21 + a12*a21^2/a13
</pre></div>
</div>
</div>
</div>
<p>The weighted adjacency matrix for <code class="docutils literal notranslate"><span class="pre">G</span></code> is</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">G</span><span class="o">.</span><span class="n">weighted_adjacency_matrix</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>[  0 a12 a13   0]
[a21   0 a23   0]
[a31 a32   0 a34]
[  0   0 a43   0]
</pre></div>
</div>
</div>
</div>
<p>The Laplacian of <code class="docutils literal notranslate"><span class="pre">G</span></code> is:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">G</span><span class="o">.</span><span class="n">laplacian_matrix</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>[      a21 + a31            -a12            -a13               0]
[           -a21       a12 + a32            -a23               0]
[           -a31            -a32 a13 + a23 + a43            -a34]
[              0               0            -a43             a34]
</pre></div>
</div>
</div>
</div>
<p>This matrix is sometimes referred to as the <code class="docutils literal notranslate"><span class="pre">combinatorial</span> <span class="pre">Laplacian</span> <span class="pre">matrix</span></code> of the weighted directed graph <code class="docutils literal notranslate"><span class="pre">G</span></code>.</p>
<p>The generator matrix <code class="docutils literal notranslate"><span class="pre">Q</span></code> for the Markov chain associated to <code class="docutils literal notranslate"><span class="pre">G</span></code> can be constructed from the weighted adjacency matrix <code class="docutils literal notranslate"><span class="pre">A</span></code> as folows.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">Q</span> <span class="o">=</span> <span class="n">A</span> <span class="o">-</span> <span class="n">diagonal_matrix</span><span class="p">(</span><span class="nb">sum</span><span class="p">(</span><span class="n">A</span><span class="o">.</span><span class="n">T</span><span class="p">))</span>
</pre></div>
</div>
</div>
</div>
<p>The following code defines <code class="docutils literal notranslate"><span class="pre">e</span></code> to be column vector of ones.  This is used to show that each row of <code class="docutils literal notranslate"><span class="pre">Q</span></code> sums to zero.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">e</span> <span class="o">=</span> <span class="n">matrix</span><span class="p">([</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">])</span><span class="o">.</span><span class="n">T</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="nb">print</span><span class="p">(</span><span class="n">Q</span><span class="o">*</span><span class="n">e</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>[0]
[0]
[0]
[0]
</pre></div>
</div>
</div>
</div>
<p>Multiplying on the left by the transpose of <code class="docutils literal notranslate"><span class="pre">e</span></code>, given by <code class="docutils literal notranslate"><span class="pre">e.T</span></code>, we see that each column of <code class="docutils literal notranslate"><span class="pre">Q</span></code> does not sum to zero.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="nb">print</span><span class="p">(</span><span class="n">e</span><span class="o">.</span><span class="n">T</span><span class="o">*</span><span class="n">Q</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>[0 0 0 0]
</pre></div>
</div>
</div>
</div>
</section>
<section id="a-three-state-receptor-model">
<span id="receptors-three-state-model"></span><h2>A three-state receptor model<a class="headerlink" href="#a-three-state-receptor-model" title="Permalink to this heading">#</a></h2>
<p>As a simple example, consider a receptor model with three states arranged as follows.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">G</span> <span class="o">=</span> <span class="n">DiGraph</span><span class="p">({</span><span class="mi">0</span><span class="p">:</span> <span class="p">{</span><span class="mi">1</span><span class="p">:</span><span class="s1">&#39;a01&#39;</span><span class="p">},</span> <span class="mi">1</span><span class="p">:</span> <span class="p">{</span><span class="mi">0</span><span class="p">:</span><span class="s1">&#39;a10&#39;</span><span class="p">,</span> <span class="mi">2</span><span class="p">:</span><span class="s1">&#39;a12&#39;</span><span class="p">},</span> <span class="mi">2</span><span class="p">:</span> <span class="p">{</span><span class="mi">1</span><span class="p">:</span><span class="s1">&#39;a21&#39;</span><span class="p">}})</span>
<span class="n">pos</span> <span class="o">=</span> <span class="p">{</span><span class="mi">0</span><span class="p">:</span> <span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">),</span> <span class="mi">1</span><span class="p">:</span> <span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">),</span> <span class="mi">2</span><span class="p">:</span> <span class="p">(</span><span class="mi">2</span><span class="p">,</span> <span class="mi">0</span><span class="p">)}</span>
<span class="n">G</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="mi">4</span><span class="p">,</span><span class="n">edge_labels</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span><span class="n">pos</span><span class="o">=</span><span class="n">pos</span><span class="p">,</span><span class="n">graph_border</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="_images/c9b675a4b4e08a74d2886ca6b0f17d6ab4813ab663d3f6d43a02449b74c78724.png" src="_images/c9b675a4b4e08a74d2886ca6b0f17d6ab4813ab663d3f6d43a02449b74c78724.png" />
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">G</span> <span class="o">=</span> <span class="n">DiGraph</span><span class="p">({</span><span class="s1">&#39;R&#39;</span><span class="p">:</span> <span class="p">{</span><span class="s1">&#39;RL&#39;</span><span class="p">:</span><span class="s1">&#39;kap*L&#39;</span><span class="p">},</span> <span class="s1">&#39;RL&#39;</span><span class="p">:</span> <span class="p">{</span><span class="s1">&#39;R&#39;</span><span class="p">:</span><span class="s1">&#39;kam&#39;</span><span class="p">,</span> <span class="s1">&#39;RLL&#39;</span><span class="p">:</span><span class="s1">&#39;kbp*L&#39;</span><span class="p">},</span> <span class="s1">&#39;RLL&#39;</span><span class="p">:</span> <span class="p">{</span><span class="s1">&#39;RL&#39;</span><span class="p">:</span><span class="s1">&#39;kbm&#39;</span><span class="p">}})</span>
<span class="n">pos</span> <span class="o">=</span> <span class="p">{</span><span class="s1">&#39;R&#39;</span><span class="p">:</span> <span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">),</span> <span class="s1">&#39;RL&#39;</span><span class="p">:</span> <span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">),</span> <span class="s1">&#39;RLL&#39;</span><span class="p">:</span> <span class="p">(</span><span class="mi">2</span><span class="p">,</span> <span class="mi">0</span><span class="p">)}</span>
<span class="n">G</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="mi">4</span><span class="p">,</span><span class="n">edge_labels</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span><span class="n">pos</span><span class="o">=</span><span class="n">pos</span><span class="p">,</span><span class="n">graph_border</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span><span class="n">vertex_size</span><span class="o">=</span><span class="mi">1000</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="_images/68d0ec1b29bb3184f4ba76a8f265eea31cfd3b1a5b27a4ca532a77dde4bca6e5.png" src="_images/68d0ec1b29bb3184f4ba76a8f265eea31cfd3b1a5b27a4ca532a77dde4bca6e5.png" />
</div>
</div>
<p>When both forward and reverse transitions are explicit, the state-transition diagram has the topology of a symmetric directed version of the <a class="reference internal" href="example_graphs.html#example-graphs-path-graph"><span class="std std-ref">path graph</span></a> with 3 vertices.</p>
<p>Here is the (undirected) path graph <span class="math notranslate nohighlight">\(P_3\)</span>:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">G</span> <span class="o">=</span> <span class="n">Graph</span><span class="p">({</span><span class="mi">0</span><span class="p">:</span> <span class="p">[</span><span class="mi">1</span><span class="p">],</span> <span class="mi">1</span><span class="p">:</span> <span class="p">[</span><span class="mi">2</span><span class="p">]})</span>
<span class="n">G</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="mi">4</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="_images/f8304dc2989bfed57d71c62347f09b78fbf3f9fa54614545c1cfb19b489fa1c3.png" src="_images/f8304dc2989bfed57d71c62347f09b78fbf3f9fa54614545c1cfb19b489fa1c3.png" />
</div>
</div>
<p>The symmetric directed version is</p>
<div class="cell tag_hide-input docutils container">
<details class="hide above-input">
<summary aria-label="Toggle hidden content">
<span class="collapsed">Show code cell source</span>
<span class="expanded">Hide code cell source</span>
</summary>
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">G</span> <span class="o">=</span> <span class="n">DiGraph</span><span class="p">({</span><span class="mi">0</span><span class="p">:</span> <span class="p">[</span><span class="mi">1</span><span class="p">],</span> <span class="mi">1</span><span class="p">:</span> <span class="p">[</span><span class="mi">0</span><span class="p">,</span><span class="mi">2</span><span class="p">],</span> <span class="mi">2</span><span class="p">:</span> <span class="p">[</span><span class="mi">1</span><span class="p">]})</span>
<span class="n">G</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="mi">4</span><span class="p">)</span>
</pre></div>
</div>
</div>
</details>
<div class="cell_output docutils container">
<img alt="_images/157e8eeb5b1537fe9f93706e492b721389f028cc1173eea24bdce1acb741484b.png" src="_images/157e8eeb5b1537fe9f93706e492b721389f028cc1173eea24bdce1acb741484b.png" />
</div>
</div>
<p>Our practice will be to define symbolic variables and put these on the vertices and edges.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">var</span><span class="p">(</span><span class="s1">&#39;a b c kappa_b_plus kappa_b_minus kappa_c_plus kappa_c_minus&#39;</span><span class="p">)</span>
<span class="n">G</span> <span class="o">=</span> <span class="n">DiGraph</span><span class="p">([[</span><span class="n">a</span><span class="p">,</span><span class="n">b</span><span class="p">,</span><span class="n">c</span><span class="p">],[(</span><span class="n">a</span><span class="p">,</span><span class="n">b</span><span class="p">),(</span><span class="n">b</span><span class="p">,</span><span class="n">a</span><span class="p">),(</span><span class="n">b</span><span class="p">,</span><span class="n">c</span><span class="p">),(</span><span class="n">c</span><span class="p">,</span><span class="n">b</span><span class="p">)]])</span>
<span class="n">G</span><span class="o">.</span><span class="n">set_edge_label</span><span class="p">(</span><span class="n">a</span><span class="p">,</span><span class="n">b</span><span class="p">,</span><span class="n">kappa_b_plus</span><span class="p">)</span>
<span class="n">G</span><span class="o">.</span><span class="n">set_edge_label</span><span class="p">(</span><span class="n">b</span><span class="p">,</span><span class="n">a</span><span class="p">,</span><span class="n">kappa_b_minus</span><span class="p">)</span>
<span class="n">G</span><span class="o">.</span><span class="n">set_edge_label</span><span class="p">(</span><span class="n">b</span><span class="p">,</span><span class="n">c</span><span class="p">,</span><span class="n">kappa_c_plus</span><span class="p">)</span>
<span class="n">G</span><span class="o">.</span><span class="n">set_edge_label</span><span class="p">(</span><span class="n">c</span><span class="p">,</span><span class="n">b</span><span class="p">,</span><span class="n">kappa_c_minus</span><span class="p">)</span>
<span class="n">G</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="mi">4</span><span class="p">,</span><span class="n">edge_labels</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="_images/21351a652bae4c05d3a78d630afb7c836e5b3724a8d8d7bec3dc531b87cc187e.png" src="_images/21351a652bae4c05d3a78d630afb7c836e5b3724a8d8d7bec3dc531b87cc187e.png" />
</div>
</div>
<p>In the state-transition diagram shown above, <span class="math notranslate nohighlight">\(\kappab\)</span> and <span class="math notranslate nohighlight">\(\kappac\)</span> are dimensionless equilibrium constants, <span class="math notranslate nohighlight">\(\kappabstar\)</span> and <span class="math notranslate nohighlight">\(\kappacstar\)</span> are association constants with physical dimension of inverse concentration, and <span class="math notranslate nohighlight">\(x\)</span> is ligand concentration.  The solid harpoons indicate the forward reaction direction.  For example, the reaction labelled <span class="math notranslate nohighlight">\(\kappab\)</span> has <span class="math notranslate nohighlight">\(a\)</span> as reactant and <span class="math notranslate nohighlight">\(b\)</span> as product; consequently, increasing <span class="math notranslate nohighlight">\(\kappab\)</span> decreases the equilibrium probability (relative fraction) of state <span class="math notranslate nohighlight">\(a\)</span> and increases the probability of state <span class="math notranslate nohighlight">\(b\)</span>.
The three states of Equation XXX are labelled so that the reactant comes before the product in dictionary order (<span class="math notranslate nohighlight">\(a\)</span> to <span class="math notranslate nohighlight">\(b\)</span> to <span class="math notranslate nohighlight">\(c\)</span>).  The subscript of the equilibrium constants <span class="math notranslate nohighlight">\(\kappab\)</span> and <span class="math notranslate nohighlight">\(\kappac\)</span> are chosen to match the label of the reaction products.</p>
<p>For an isolated monomer with a state-transition diagram given by Equation XXX, the probability of state <span class="math notranslate nohighlight">\(i\)</span> is given by
<span class="math notranslate nohighlight">\(\pi_i = z_i / z_T\)</span> where  <span class="math notranslate nohighlight">\(z_T= \textstyle \sum_i z_i\)</span>,
<span class="math notranslate nohighlight">\(z_a = 1\)</span>,
<span class="math notranslate nohighlight">\(z_b = \kappab = \kappabstar x\)</span>, and
<span class="math notranslate nohighlight">\(z_c =\kappab \kappac = \kappabstar \kappacstar x^2\)</span>. That is,</p>
<div class="amsmath math notranslate nohighlight" id="equation-a1dcacd3-0afa-4bf4-9cce-d3caed4ba925">
<span class="eqno">()<a class="headerlink" href="#equation-a1dcacd3-0afa-4bf4-9cce-d3caed4ba925" title="Permalink to this equation">#</a></span>\[\begin{equation}
\pi_a =  \frac{1}{1+ \kappabstar x  +  \kappabstar \kappacstar x^2} \, ,  \quad \pi_b =  \frac{\kappabstar x}{1+ \kappabstar x +  \kappabstar  \kappacstar x^2}   \quad \mbox{and}  \quad \pi_c = \frac{\kappabstar  \kappacstar x^2 }{1+ \kappabstar x +  \kappabstar \kappacstar x^2 }  \, .
\end{equation}\]</div>
<p>It is helpful to  present this set of rational functions using the following compact notation:</p>
<div class="amsmath math notranslate nohighlight" id="equation-beb3b121-6236-48ae-b14d-e2e258fac9da">
<span class="eqno">()<a class="headerlink" href="#equation-beb3b121-6236-48ae-b14d-e2e258fac9da" title="Permalink to this equation">#</a></span>\[\begin{equation}
 [ \pi_a  :  \pi_b :  \pi_c ] = [1 :\kappab : \kappab \kappac ]  = [1 : \kappabstar x :\kappabstar \kappacstar x^2  ] \,  .
\end{equation}\]</div>
<p>In expressions of this kind,  it is understood that</p>
<div class="amsmath math notranslate nohighlight" id="equation-1720a5f2-518b-4ced-97ba-c753deeed117">
<span class="eqno">()<a class="headerlink" href="#equation-1720a5f2-518b-4ced-97ba-c753deeed117" title="Permalink to this equation">#</a></span>\[\begin{equation}
[ x_1 \! : \! x_2 : \! \cdots \! : \! x_n ] = [ \lambda x_1 \! : \! \lambda  x_2 : \! \cdots \! : \! \lambda  x_n ]
\end{equation}\]</div>
<p>for any <span class="math notranslate nohighlight">\(\lambda \neq 0\)</span>. Furthermore, <span class="math notranslate nohighlight">\(\lambda = 1/\sum_i x_n\)</span> gives the probability distribution <span class="math notranslate nohighlight">\(\pi = (\pi_1, \pi_2, \ldots, \pi_n)\)</span> where <span class="math notranslate nohighlight">\(1=\sum_i \pi_i\)</span>.</p>
<p>One reason for using symbolic variables is that we can produce symbolic expressions important quantities using <a class="reference external" href="https://doc.sagemath.org/html/en/reference/graphs/index.html">module for graphs and digraphs</a> available in <code class="docutils literal notranslate"><span class="pre">Sagemath</span></code>. For example, the weighted adjacency matrix associated with graph {math}`G$ above is</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">A</span> <span class="o">=</span> <span class="n">G</span><span class="o">.</span><span class="n">weighted_adjacency_matrix</span><span class="p">()</span>
<span class="nb">print</span><span class="p">(</span><span class="n">A</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>[            0  kappa_b_plus             0]
[kappa_b_minus             0  kappa_c_plus]
[            0 kappa_c_minus             0]
</pre></div>
</div>
</div>
</div>
<p>If we are interested in the equilibrium probability of each state of the receptor model, it is sufficient to consider the rooted spanning tree</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">var</span><span class="p">(</span><span class="s1">&#39;a b c kappa_b kappa_c&#39;</span><span class="p">)</span>
<span class="n">T</span> <span class="o">=</span> <span class="n">DiGraph</span><span class="p">([[</span><span class="n">a</span><span class="p">,</span><span class="n">b</span><span class="p">,</span><span class="n">c</span><span class="p">],[(</span><span class="n">b</span><span class="p">,</span><span class="n">a</span><span class="p">),(</span><span class="n">c</span><span class="p">,</span><span class="n">b</span><span class="p">)]])</span>
<span class="n">T</span><span class="o">.</span><span class="n">set_edge_label</span><span class="p">(</span><span class="n">b</span><span class="p">,</span><span class="n">a</span><span class="p">,</span><span class="n">kappa_b</span><span class="p">)</span>
<span class="n">T</span><span class="o">.</span><span class="n">set_edge_label</span><span class="p">(</span><span class="n">c</span><span class="p">,</span><span class="n">b</span><span class="p">,</span><span class="n">kappa_c</span><span class="p">)</span>
<span class="n">T</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="mi">4</span><span class="p">,</span><span class="n">edge_labels</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="_images/77861e85cfdd1dbd3f65d54abc35d42880b2f0b656c7195ffa73c17af6193f32.png" src="_images/77861e85cfdd1dbd3f65d54abc35d42880b2f0b656c7195ffa73c17af6193f32.png" />
</div>
</div>
<p>[To be completed]</p>
</section>
</section>
<section id="scraps">
<h1>Scraps<a class="headerlink" href="#scraps" title="Permalink to this heading">#</a></h1>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">B</span> <span class="o">=</span> <span class="n">T</span><span class="o">.</span><span class="n">weighted_adjacency_matrix</span><span class="p">()</span>
<span class="nb">print</span><span class="p">(</span><span class="n">B</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="n">B</span><span class="o">**</span><span class="mi">2</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="n">B</span><span class="o">**</span><span class="mi">3</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>[      0       0       0]
[kappa_b       0       0]
[      0 kappa_c       0]
[              0               0               0]
[              0               0               0]
[kappa_b*kappa_c               0               0]
[0 0 0]
[0 0 0]
[0 0 0]
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="nb">print</span><span class="p">(</span><span class="n">B</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="n">B</span><span class="o">**</span><span class="mi">2</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="n">B</span><span class="o">**</span><span class="mi">3</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>[      0       0       0]
[kappa_b       0       0]
[      0 kappa_c       0]
[              0               0               0]
[              0               0               0]
[kappa_b*kappa_c               0               0]
[0 0 0]
[0 0 0]
[0 0 0]
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">G</span><span class="o">=</span><span class="n">graphs</span><span class="o">.</span><span class="n">PathGraph</span><span class="p">(</span><span class="mi">3</span><span class="p">)</span>
<span class="n">G</span><span class="o">.</span><span class="n">show</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="mi">4</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="_images/07df6c2708284fade3a1ccf2afad84c119f1a0fba30f16137fc3733612ddc21c.png" src="_images/07df6c2708284fade3a1ccf2afad84c119f1a0fba30f16137fc3733612ddc21c.png" />
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">G</span><span class="o">.</span><span class="n">relabel</span><span class="p">(</span><span class="nb">dict</span><span class="p">({</span><span class="mi">0</span><span class="p">:</span> <span class="s1">&#39;a&#39;</span><span class="p">,</span> <span class="mi">1</span><span class="p">:</span> <span class="s1">&#39;b&#39;</span><span class="p">,</span> <span class="mi">2</span><span class="p">:</span> <span class="s1">&#39;c&#39;</span><span class="p">}))</span>
<span class="n">G</span><span class="o">.</span><span class="n">show</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="mi">4</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="_images/64b3d8866b033fded99eddd67d55e7f7d799b7d7019901dd75ad392c8d12de0f.png" src="_images/64b3d8866b033fded99eddd67d55e7f7d799b7d7019901dd75ad392c8d12de0f.png" />
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">kappab</span> <span class="o">=</span> <span class="n">var</span><span class="p">(</span><span class="s2">&quot;kappab&quot;</span><span class="p">,</span> <span class="n">latex_name</span><span class="o">=</span><span class="sa">r</span><span class="s2">&quot;\kappa_b&quot;</span><span class="p">)</span>
<span class="n">kappac</span> <span class="o">=</span> <span class="n">var</span><span class="p">(</span><span class="s2">&quot;kappac&quot;</span><span class="p">,</span> <span class="n">latex_name</span><span class="o">=</span><span class="sa">r</span><span class="s2">&quot;\kappa_c&quot;</span><span class="p">)</span>
<span class="n">x</span> <span class="o">=</span> <span class="n">var</span><span class="p">(</span><span class="s2">&quot;x&quot;</span><span class="p">,</span> <span class="n">latex_name</span><span class="o">=</span><span class="sa">r</span><span class="s2">&quot;x&quot;</span><span class="p">)</span>
<span class="n">G</span><span class="o">.</span><span class="n">set_edge_label</span><span class="p">(</span><span class="s1">&#39;a&#39;</span><span class="p">,</span><span class="s1">&#39;b&#39;</span><span class="p">,</span><span class="n">kappab</span><span class="o">*</span><span class="n">x</span><span class="p">)</span>
<span class="n">G</span><span class="o">.</span><span class="n">set_edge_label</span><span class="p">(</span><span class="s1">&#39;b&#39;</span><span class="p">,</span><span class="s1">&#39;c&#39;</span><span class="p">,</span><span class="n">kappab</span><span class="o">*</span><span class="n">kappac</span><span class="o">*</span><span class="n">x</span><span class="o">^</span><span class="mi">2</span><span class="p">)</span>
<span class="n">G</span><span class="o">.</span><span class="n">show</span><span class="p">(</span><span class="n">edge_labels</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span><span class="n">figsize</span><span class="o">=</span><span class="mi">8</span><span class="p">)</span>
<span class="n">f</span><span class="o">=</span><span class="n">kappab</span><span class="o">*</span><span class="n">kappac</span><span class="o">*</span><span class="n">x</span><span class="o">^</span><span class="mi">2</span>
<span class="n">f</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
<span class="n">show</span><span class="p">(</span><span class="n">f</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="n">f</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="_images/d7727288eb23c562ed019564bec567a5a0aa683183be7d069417ef5fec930adc.png" src="_images/d7727288eb23c562ed019564bec567a5a0aa683183be7d069417ef5fec930adc.png" />
<div class="output text_html"><html>\(\displaystyle {\kappa_b} {\kappa_c} {x}^{2}\)</html></div><div class="output text_html"><html>\(\displaystyle {\kappa_b} {\kappa_c} {x}^{2}\)</html></div><div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>kappab*kappac*x^2
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">G</span><span class="o">=</span><span class="n">graphs</span><span class="o">.</span><span class="n">PathGraph</span><span class="p">(</span><span class="mi">3</span><span class="p">)</span><span class="o">.</span><span class="n">to_directed</span><span class="p">()</span>
<span class="n">G</span><span class="o">.</span><span class="n">relabel</span><span class="p">({</span><span class="mi">0</span><span class="p">:</span><span class="s1">&#39;R&#39;</span><span class="p">,</span><span class="mi">1</span><span class="p">:</span><span class="s1">&#39;LR&#39;</span><span class="p">,</span><span class="mi">2</span><span class="p">:</span><span class="s1">&#39;LLR&#39;</span><span class="p">})</span>
<span class="n">G</span><span class="o">.</span><span class="n">set_edge_label</span><span class="p">(</span><span class="s1">&#39;R&#39;</span><span class="p">,</span><span class="s1">&#39;LR&#39;</span><span class="p">,</span><span class="s1">&#39;kap*L&#39;</span><span class="p">)</span>
<span class="n">G</span><span class="o">.</span><span class="n">set_edge_label</span><span class="p">(</span><span class="s1">&#39;LR&#39;</span><span class="p">,</span><span class="s1">&#39;R&#39;</span><span class="p">,</span><span class="s1">&#39;kam&#39;</span><span class="p">)</span>
<span class="n">G</span><span class="o">.</span><span class="n">set_edge_label</span><span class="p">(</span><span class="s1">&#39;LR&#39;</span><span class="p">,</span><span class="s1">&#39;LLR&#39;</span><span class="p">,</span><span class="s1">&#39;kbp*L&#39;</span><span class="p">)</span>
<span class="n">G</span><span class="o">.</span><span class="n">set_edge_label</span><span class="p">(</span><span class="s1">&#39;LLR&#39;</span><span class="p">,</span><span class="s1">&#39;LR&#39;</span><span class="p">,</span><span class="s1">&#39;kbm&#39;</span><span class="p">)</span>
<span class="n">G</span><span class="o">.</span><span class="n">show</span><span class="p">(</span><span class="n">edge_labels</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span><span class="n">figsize</span><span class="o">=</span><span class="mi">4</span><span class="p">,</span><span class="n">talk</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<span class="n">G</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">edge_labels</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span><span class="n">figsize</span><span class="o">=</span><span class="mi">4</span><span class="p">,</span><span class="n">talk</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="_images/9da02c28ac3de76a8eaf658f9ae02bfa2dd5749b2ed4d26942fe81575d9b27c1.png" src="_images/9da02c28ac3de76a8eaf658f9ae02bfa2dd5749b2ed4d26942fe81575d9b27c1.png" />
<img alt="_images/9da02c28ac3de76a8eaf658f9ae02bfa2dd5749b2ed4d26942fe81575d9b27c1.png" src="_images/9da02c28ac3de76a8eaf658f9ae02bfa2dd5749b2ed4d26942fe81575d9b27c1.png" />
</div>
</div>
<section id="references">
<h2>References<a class="headerlink" href="#references" title="Permalink to this heading">#</a></h2>
<div class="docutils container" id="id2">
<div class="citation" id="id3" role="doc-biblioentry">
<span class="label"><span class="fn-bracket">[</span><a role="doc-backlink" href="#id1">Ken18</a><span class="fn-bracket">]</span></span>
<p>Terry P Kenakin. <em>A pharmacology primer: techniques for more effective and strategic drug discovery</em>. Academic Press, 2018.</p>
</div>
</div>
</div>
</section>
</section>

    <script type="text/x-thebe-config">
    {
        requestKernel: true,
        binderOptions: {
            repo: "binder-examples/jupyter-stacks-datascience",
            ref: "master",
        },
        codeMirrorConfig: {
            theme: "abcdef",
            mode: "sage-10.0"
        },
        kernelOptions: {
            name: "sage-10.0",
            path: "./."
        },
        predefinedOutput: true
    }
    </script>
    <script>kernelName = 'sage-10.0'</script>

                </article>
              

              
              
                <footer class="bd-footer-article">
                  
<div class="footer-article-items footer-article__inner">
  
    <div class="footer-article-item"><!-- Previous / next buttons -->
<div class="prev-next-area">
</div></div>
  
</div>

                </footer>
              
            </div>
            
            
              
                <div class="bd-sidebar-secondary bd-toc"><div class="sidebar-secondary-items sidebar-secondary__inner">

  <div class="sidebar-secondary-item">
  <div class="page-toc tocsection onthispage">
    <i class="fa-solid fa-list"></i> Contents
  </div>
  <nav class="bd-toc-nav page-toc">
    <ul class="visible nav section-nav flex-column">
<li class="toc-h1 nav-item toc-entry"><a class="reference internal nav-link" href="#">Receptor models</a><ul class="visible nav section-nav flex-column">
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#states-and-transitions">States and transitions</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#transition-rate-constants">Transition rate constants</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#a-three-state-receptor-model">A three-state receptor model</a></li>
</ul>
</li>
<li class="toc-h1 nav-item toc-entry"><a class="reference internal nav-link" href="#scraps">Scraps</a><ul class="visible nav section-nav flex-column">
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#references">References</a></li>
</ul>
</li>
</ul>

  </nav></div>

</div></div>
              
            
          </div>
          <footer class="bd-footer-content">
            
<div class="bd-footer-content__inner container">
  
  <div class="footer-item">
    
<p class="component-author">
By Greg Conradi Smith
</p>

  </div>
  
  <div class="footer-item">
    
  <p class="copyright">
    
      © Copyright 2022.
      <br/>
    
  </p>

  </div>
  
  <div class="footer-item">
    
  </div>
  
  <div class="footer-item">
    
  </div>
  
</div>
          </footer>
        

      </main>
    </div>
  </div>
  
  <!-- Scripts loaded after <body> so the DOM is not blocked -->
  <script src="_static/scripts/bootstrap.js?digest=e353d410970836974a52"></script>
<script src="_static/scripts/pydata-sphinx-theme.js?digest=e353d410970836974a52"></script>

  <footer class="bd-footer">
  </footer>
  </body>
</html>